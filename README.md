# Usefull scripts for PEN-300

Upon preparing for my PEN-300 exams, I created different scripts to help me out. The following scripts are available:

* encode_payload.py     - encode a c# or vb payload with ROT or XOR
* rot_obfuscate.py      - simple script to obfuscate a powershell payload
* amsi.ps1		- AMSI bypass script
* amsi-bypass.ps	- AMSI bypass script which modifies the code to XOR AX, AX which will always result in a fail

## encode_payload.py
I created this script in order to encode payloads via ROT or XOR. The course material directs you to use the `helper` app created using C#, but I found a Python script much, much easier. Usage:

```
encode_payload.py -t / --type <vb or csharp) -b / --bytes <ROT or XOR value> -o / --output <outfile> -e / --encryption <rot or xor> input file
```

The code is not done yet. The ROT-encoding (Caesar cipher) for C# isn't implemented yet. The output results for VB and C# include a decryption routine as well allowing for easy copy/paste into your code.

### Example: Show help page
This command displays the help page:
```
python3 ./encode_payload.py -h                                                          
usage: encode_rot.py [-h] -t TYPE -b BYTES -o OUTPUT -e ENCRYPTION filename

This program applies ROT (Caesar) encryption to payloads generated by msfvenom

positional arguments:
  filename

options:
  -h, --help            show this help message and exit
  -t TYPE, --type TYPE  Specifies file type. Choices are: vb, csharp
  -b BYTES, --bytes BYTES
                        Specifies the number of bytes to rotate or the byte to XOR with (integer, decimal)
  -o OUTPUT, --output OUTPUT
                        Specifies the output file name
  -e ENCRYPTION, --encryption ENCRYPTION
                        Specifies encryption scheme. Choices are: xor, rot

I found a python script easier than the C# solution from the learning guide.
```

### Example: XOR C-Sharp payload
```
$ python3 ./encode_payload.py -t csharp -b 170 -o rev-serviio-xor.cs -e xor rev-serviio.cs
[-] CSharp mode
[-] Converting rev-serviio.cs to rev-serviio-xor.cs, XOR-ring with 0xAA.
[+] Conversion done. Payload size: 789 bytes.
```

## rot_obfuscate.py

Simple script to obfuscate a Powershell payload. Adjust rotation number and payload in the script.

